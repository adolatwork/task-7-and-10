{% extends "app/base.html" %}

{% block header_title %}{{ view_name }}{% endblock %}

{% block content %}
<div class="alert {% if 'Inefficient' in view_name %}alert-warning{% else %}alert-success{% endif %}">
    <h2>{{ view_name }}</h2>
    <p>{{ description }}</p>
    <p><strong>Check the django-debug-toolbar on the right side to see the query count!</strong></p>
</div>

<table>
    <thead>
        <tr>
            <th>Title</th>
            <th>Author</th>
            <th>Publisher</th>
            <th>Categories</th>
            <th>Price</th>
            <th>Published Date</th>
        </tr>
    </thead>
    <tbody>
        {% for book in books %}
        <tr>
            <td><strong>{{ book.title }}</strong></td>
            <td>{{ book.author.name }}</td>
            <td>{% if book.publisher %}{{ book.publisher.name }}{% else %}N/A{% endif %}</td>
            <td>
                {% for category in book.categories.all %}
                    <span class="badge badge-primary">{{ category.name }}</span>
                {% empty %}
                    <span>No categories</span>
                {% endfor %}
            </td>
            <td>${{ book.price }}</td>
            <td>{{ book.published_date }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6" style="text-align: center; padding: 30px;">
                <p>No books found. Please run the management command to populate test data:</p>
                <code>python manage.py populate_data</code>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
    <h3>What to look for in django-debug-toolbar:</h3>
    <ul style="margin-left: 20px; margin-top: 10px;">
        <li>Total number of SQL queries executed</li>
        <li>Duplicate queries (indicated in red)</li>
        <li>Time taken for each query</li>
        <li>Query details by clicking on the SQL panel</li>
    </ul>
</div>
{% endblock %}

